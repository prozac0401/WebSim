                <h3 style="
                    color: #2c3e50;
                    margin-top: 0;
                ">ì‚¬ìš©ë²•</h3>
                <p><strong>ìœ„ì„± ë°œì‚¬:</strong> ë¹ˆ ê³µê°„ì—ì„œ ë“œë˜ê·¸í•˜ì—¬ ìœ„ì„±ì„ ë°œì‚¬ (ì‹œë®¬ë ˆì´ì…˜ ì¤‘ì—ë„ ê°€ëŠ¥)</p>
                <p><strong>ë¸”ë™í™€ ì´ë™:</strong> ë¸”ë™í™€ì„ í´ë¦­í•˜ê³  ë“œë˜ê·¸í•˜ì—¬ ìœ„ì¹˜ë¥¼ ë³€ê²½</p>
                <p><strong>ë¸”ë™í™€ ì‚­ì œ:</strong> ë¸”ë™í™€ì„ ë”ë¸”í´ë¦­í•˜ì—¬ ì œê±° (ìµœì†Œ 1ê°œ ìœ ì§€)</p>
                <p><strong>ë¬´ì‘ìœ„ ìœ„ì„±:</strong> ë¬´ì‘ìœ„ ìœ„ì„± ë²„íŠ¼ìœ¼ë¡œ ì„¤ì •í•œ ê°œìˆ˜ë§Œí¼ ìœ„ì„±ì„ ìƒì„± (1~50ê°œ)</p>
                <p><strong>ì¶©ëŒ ëª¨ë“œ:<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¸”ë™í™€ ì¤‘ë ¥ ì‹œë®¬ë ˆì´í„°</title>
</head>
<body>
    <div style="
        margin: 0;
        padding: 20px;
        color: #333;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        overflow-x: hidden;
    ">
        <div style="
            max-width: 800px;
            margin: 0 auto;
        ">
            
            <div style="
                position: relative;
                width: 100%;
                max-width: 700px;
                aspect-ratio: 1/1;
                margin: 0 auto;
                border: 3px solid #888;
                border-radius: 10px;
                overflow: hidden;
                box-shadow: 0 0 30px rgba(136, 136, 136, 0.3);
                background: transparent;
            ">
                <canvas id="sim-canvas" style="
                    width: 100%;
                    height: 100%;
                    display: block;
                    cursor: crosshair;
                "></canvas>
                <div id="drag-indicator" style="
                    position: absolute;
                    pointer-events: none;
                    border: 2px dashed #666;
                    border-radius: 50%;
                    opacity: 0;
                    transition: opacity 0.2s;
                "></div>
            </div>
            
            <div id="status-bar" style="
                background: rgba(255, 255, 255, 0.9);
                color: #333;
                padding: 10px;
                border-radius: 5px;
                font-size: 14px;
                border: 1px solid #888;
                margin: 15px 0;
                text-align: center;
                box-shadow: 0 2px 5px rgba(136, 136, 136, 0.2);
            ">
                ë¸”ë™í™€: 1ê°œ | ìœ„ì„±: 0ê°œ | í‰ê·  ì†ë„: 0 | ì‹œê°„: 0ì´ˆ
            </div>
            
            <div style="
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                justify-content: center;
                margin: 15px 0;
            ">
                <button onclick="resetSim()" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ì´ˆê¸°í™”</button>
                
                <button onclick="startSim()" id="start-btn" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ì‹œì‘</button>
                
                <button onclick="pauseSim()" id="pause-btn" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                    display: none;
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ì¼ì‹œì •ì§€</button>
                
                <button onclick="addRandomPlanet()" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ë¸”ë™í™€ ì¶”ê°€</button>
                
                <button onclick="addRandomSatellite()" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ë¬´ì‘ìœ„ ìœ„ì„±</button>
                
                <button onclick="clearSatellites()" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ìœ„ì„± ì´ˆê¸°í™”</button>
                
                <button onclick="toggleCollision()" id="collision-btn" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ì¶©ëŒ</button>
                
                <button onclick="toggleOrbit()" id="orbit-btn" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                    opacity: 0.6;
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ê¶¤ë„</button>
                
                <button onclick="toggleVelocity()" id="velocity-btn" style="
                    background: linear-gradient(145deg, #e8e8e8, #d8d8d8);
                    color: #333;
                    border: 1px solid #888;
                    padding: 8px 16px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 12px;
                    transition: all 0.2s;
                    box-shadow: 0 2px 5px rgba(136, 136, 136, 0.3);
                " onmouseover="this.style.background='linear-gradient(145deg, #f0f0f0, #e0e0e0)'; this.style.borderColor='#666'; this.style.boxShadow='0 0 10px rgba(102, 102, 102, 0.3)';" onmouseout="this.style.background='linear-gradient(145deg, #e8e8e8, #d8d8d8)'; this.style.borderColor='#888'; this.style.boxShadow='0 2px 5px rgba(136, 136, 136, 0.3)';" onmousedown="this.style.transform='translateY(1px)';" onmouseup="this.style.transform='translateY(0)';">ë°©í–¥</button>
            </div>
            
            <div style="
                display: flex;
                gap: 20px;
                justify-content: center;
                margin: 15px 0;
                flex-wrap: wrap;
            ">
                <label style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-size: 14px;
                    color: #333;
                ">
                    ì‹œë®¬ë ˆì´ì…˜ ì†ë„: <span id="speed-mult-value">1.0</span>x
                    <input type="range" min="0.5" max="3" step="0.1" value="1" id="speed-mult" style="width: 100px;">
                </label>
                <label style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-size: 14px;
                    color: #333;
                ">
                    ì¤‘ë ¥ ê°•ë„: <span id="gravity-value">1.0</span>x
                    <input type="range" min="0.5" max="2" step="0.1" value="1" id="gravity-strength" style="width: 100px;">
                </label>
                <label style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-size: 14px;
                    color: #333;
                ">
                    ë¬´ì‘ìœ„ ìœ„ì„± ê°œìˆ˜: <span id="random-count-value">20</span>ê°œ
                    <input type="range" min="1" max="50" value="20" id="random-satellite-count" style="width: 100px;">
                </label>
            </div>
            
            <div style="
                text-align: center;
                margin-top: 20px;
                padding: 15px;
                background: rgba(255, 255, 255, 0.8);
                border-radius: 10px;
                border: 1px solid #888;
                color: #333;
            ">
                <h3 style="
                    color: #2c3e50;
                    margin-top: 0;
                ">ğŸ® ì‚¬ìš©ë²•</h3>
                <p><strong>ìœ„ì„± ë°œì‚¬:</strong> ë¹ˆ ê³µê°„ì—ì„œ ë“œë˜ê·¸í•˜ì—¬ ìœ„ì„±ì„ ë°œì‚¬í•˜ì„¸ìš” (ì‹œë®¬ë ˆì´ì…˜ ì¤‘ì—ë„ ê°€ëŠ¥)</p>
                <p><strong>ë¸”ë™í™€ ì´ë™:</strong> ë¸”ë™í™€ì„ í´ë¦­í•˜ê³  ë“œë˜ê·¸í•˜ì—¬ ìœ„ì¹˜ë¥¼ ë³€ê²½í•˜ì„¸ìš”</p>
                <p><strong>ì¶©ëŒ ëª¨ë“œ:</strong> ì¶©ëŒ ë²„íŠ¼ìœ¼ë¡œ ìœ„ì„±ì˜ ë¸”ë™í™€ ì¶©ëŒ ì—¬ë¶€ë¥¼ ì¡°ì ˆ</p>
                <p><strong>ì¤‘ë ¥ íš¨ê³¼:</strong> ë¸”ë™í™€ ê·¼ì²˜ë¥¼ ì§€ë‚˜ê°€ë©° ìœ„ì„±ì˜ ì†ë„ì™€ ë°©í–¥ì´ ë³€ê²½ë¨</p>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('sim-canvas');
        const ctx = canvas.getContext('2d');
        const statusBar = document.getElementById('status-bar');
        const dragIndicator = document.getElementById('drag-indicator');
        
        let width, height;
        let planets = [];
        let satellites = [];
        let dragging = false;
        let dragStart = null;
        let simRunning = false;
        let simTime = 0;
        let animationId = null;
        let showOrbit = false; // ê¶¤ë„ ê¸°ë³¸ê°’ off
        let showVelocity = true;
        let dragMode = 'satellite'; // 'satellite' ë˜ëŠ” 'blackhole'
        let selectedPlanet = null;
        let collisionEnabled = true; // ì¶©ëŒ í™œì„±í™” ì—¬ë¶€
        let lastClickTime = 0; // ë”ë¸”í´ë¦­ ê°ì§€ìš©
        
        // ì´ˆê¸° ì„¤ì •
        function init() {
            resizeCanvas();
            resetSim();
            setupEventListeners();
            updateUI();
            loop();
        }
        
        function resizeCanvas() {
            const container = canvas.parentElement;
            width = container.clientWidth;
            height = container.clientHeight;
            canvas.width = width;
            canvas.height = height;
        }
        
        function setupEventListeners() {
            window.addEventListener('resize', resizeCanvas);
            
            // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
            canvas.addEventListener('mousedown', handleMouseDown);
            canvas.addEventListener('mousemove', handleMouseMove);
            canvas.addEventListener('mouseup', handleMouseUp);
            
            // í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼ ì§€ì›)
            canvas.addEventListener('touchstart', handleTouchStart, {passive: false});
            canvas.addEventListener('touchmove', handleTouchMove, {passive: false});
            canvas.addEventListener('touchend', handleTouchEnd, {passive: false});
            
            // ì„¤ì • ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸
            document.getElementById('speed-mult').addEventListener('input', updateSpeedMult);
            document.getElementById('gravity-strength').addEventListener('input', updateGravityStrength);
            document.getElementById('random-satellite-count').addEventListener('input', updateRandomCount);
        }
        
        function handleMouseDown(e) {
            const rect = canvas.getBoundingClientRect();
            const mouseX = (e.clientX - rect.left) * (canvas.width / rect.width);
            const mouseY = (e.clientY - rect.top) * (canvas.height / rect.height);
            
            // ë”ë¸”í´ë¦­ ê°ì§€
            const currentTime = Date.now();
            const isDoubleClick = currentTime - lastClickTime < 300;
            lastClickTime = currentTime;
            
            // ë¸”ë™í™€ í´ë¦­ ì²´í¬ (ë¸”ë™í™€ì´ ìœ„ì„±ë³´ë‹¤ ìš°ì„ )
            selectedPlanet = null;
            for (let i = 0; i < planets.length; i++) {
                const planet = planets[i];
                const dx = mouseX - planet.x;
                const dy = mouseY - planet.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance <= planet.radius * 2) { // í´ë¦­ ì˜ì—­ì„ ì¡°ê¸ˆ ë„“ê²Œ
                    if (isDoubleClick && planets.length > 1) {
                        // ë”ë¸”í´ë¦­ìœ¼ë¡œ ë¸”ë™í™€ ì‚­ì œ (ìµœì†Œ 1ê°œëŠ” ìœ ì§€)
                        planets.splice(i, 1);
                        updateStatus();
                        return;
                    }
                    
                    selectedPlanet = planet;
                    dragMode = 'blackhole';
                    dragging = true;
                    dragStart = { x: mouseX, y: mouseY };
                    canvas.style.cursor = 'grabbing';
                    return;
                }
            }
            
            // ë¸”ë™í™€ì´ í´ë¦­ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ìœ„ì„± ë°œì‚¬ ëª¨ë“œ
            dragMode = 'satellite';
            dragging = true;
            dragStart = { x: mouseX, y: mouseY };
        }
        
        function handleMouseMove(e) {
            if (!dragging) {
                // ë§ˆìš°ìŠ¤ í˜¸ë²„ ì»¤ì„œ ë³€ê²½
                const rect = canvas.getBoundingClientRect();
                const mouseX = (e.clientX - rect.left) * (canvas.width / rect.width);
                const mouseY = (e.clientY - rect.top) * (canvas.height / rect.height);
                
                let overPlanet = false;
                for (const planet of planets) {
                    const dx = mouseX - planet.x;
                    const dy = mouseY - planet.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance <= planet.radius * 2) {
                        overPlanet = true;
                        break;
                    }
                }
                
                canvas.style.cursor = overPlanet ? 'grab' : 'crosshair';
                return;
            }
            
            const rect = canvas.getBoundingClientRect();
            const currentX = (e.clientX - rect.left) * (canvas.width / rect.width);
            const currentY = (e.clientY - rect.top) * (canvas.height / rect.height);
            
            if (dragMode === 'blackhole' && selectedPlanet) {
                // ë¸”ë™í™€ ì´ë™
                selectedPlanet.x = currentX;
                selectedPlanet.y = currentY;
            } else if (dragMode === 'satellite') {
                // ìœ„ì„± ë°œì‚¬ í‘œì‹œ
                const currentPos = { x: currentX, y: currentY };
                updateDragIndicator(dragStart, currentPos);
            }
        }
        
        function handleMouseUp(e) {
            if (!dragging) return;
            
            const rect = canvas.getBoundingClientRect();
            const endX = (e.clientX - rect.left) * (canvas.width / rect.width);
            const endY = (e.clientY - rect.top) * (canvas.height / rect.height);
            
            if (dragMode === 'satellite') {
                // ìœ„ì„± ë°œì‚¬
                const endPos = { x: endX, y: endY };
                launchSatellite(dragStart, endPos);
                hideDragIndicator();
            }
            
            // ë“œë˜ê·¸ ìƒíƒœ ì´ˆê¸°í™”
            dragging = false;
            selectedPlanet = null;
            dragMode = 'satellite';
            canvas.style.cursor = 'crosshair';
        }
        
        function handleTouchStart(e) {
            e.preventDefault();
            const touch = e.touches[0];
            handleMouseDown({clientX: touch.clientX, clientY: touch.clientY});
        }
        
        function handleTouchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            handleMouseMove({clientX: touch.clientX, clientY: touch.clientY});
        }
        
        function handleTouchEnd(e) {
            e.preventDefault();
            const touch = e.changedTouches[0];
            handleMouseUp({clientX: touch.clientX, clientY: touch.clientY});
        }
        
        function updateDragIndicator(start, current) {
            const dx = current.x - start.x;
            const dy = current.y - start.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            dragIndicator.style.left = (start.x - distance/2) + 'px';
            dragIndicator.style.top = (start.y - distance/2) + 'px';
            dragIndicator.style.width = distance + 'px';
            dragIndicator.style.height = distance + 'px';
            dragIndicator.style.opacity = '0.5';
        }
        
        function hideDragIndicator() {
            dragIndicator.style.opacity = '0';
        }
        
        function launchSatellite(start, end) {
            const dx = (end.x - start.x) * 0.1;
            const dy = (end.y - start.y) * 0.1;
            
            const newSatellite = {
                x: start.x,
                y: start.y,
                vx: dx,
                vy: dy,
                orbit: [],
                color: `hsl(${Math.random() * 360}, 70%, 60%)`,
                id: Date.now() + Math.random()
            };
            
            satellites.push(newSatellite);
            
            simTime = 0;
            updateStatus();
        }
        
        function updatePlanetCount() {
            const gravityStrength = parseFloat(document.getElementById('gravity-strength').value);
            
            planets = [];
            
            // ê¸°ë³¸ ë¸”ë™í™€ 1ê°œ ìƒì„± (ì¤‘ì•™ì— ë°°ì¹˜, í†µì¼ëœ í¬ê¸°)
            planets.push({
                x: width / 2,
                y: height / 2,
                mass: 15000 * gravityStrength,
                radius: 20, // í†µì¼ëœ í¬ê¸°
                color: '#000000'
            });
            
            updateStatus();
        }
        
        function updateSpeedMult() {
            const value = parseFloat(document.getElementById('speed-mult').value);
            document.getElementById('speed-mult-value').textContent = value.toFixed(1);
        }
        
        function updateGravityStrength() {
            const value = parseFloat(document.getElementById('gravity-strength').value);
            document.getElementById('gravity-value').textContent = value.toFixed(1);
            // ì¤‘ë ¥ ê°•ë„ ë³€ê²½ì‹œ ë¸”ë™í™€ì„ 1ê°œë¡œ ì´ˆê¸°í™”
            updatePlanetCount();
        }
        
        function updateRandomCount() {
            const value = parseInt(document.getElementById('random-satellite-count').value);
            document.getElementById('random-count-value').textContent = value;
        }
        
        function addRandomPlanet() {
            if (planets.length >= 3) {
                alert('ìµœëŒ€ 3ê°œì˜ ë¸”ë™í™€ê¹Œì§€ë§Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            const gravityStrength = parseFloat(document.getElementById('gravity-strength').value);
            let attempts = 0;
            let validPosition = false;
            let newPlanet;
            
            // ê¸°ì¡´ ë¸”ë™í™€ê³¼ ë„ˆë¬´ ê°€ê¹ì§€ ì•Šì€ ìœ„ì¹˜ ì°¾ê¸°
            while (!validPosition && attempts < 20) {
                newPlanet = {
                    x: Math.random() * (width - 100) + 50,
                    y: Math.random() * (height - 100) + 50,
                    mass: (8000 + Math.random() * 4000) * gravityStrength,
                    radius: 20, // í†µì¼ëœ í¬ê¸°
                    color: '#000000'
                };
                
                validPosition = true;
                
                // ê¸°ì¡´ ë¸”ë™í™€ë“¤ê³¼ì˜ ê±°ë¦¬ ì²´í¬
                for (const planet of planets) {
                    const dx = newPlanet.x - planet.x;
                    const dy = newPlanet.y - planet.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < (newPlanet.radius + planet.radius + 50)) {
                        validPosition = false;
                        break;
                    }
                }
                
                attempts++;
            }
            
            if (validPosition) {
                planets.push(newPlanet);
                updateStatus();
            } else {
                alert('ì ì ˆí•œ ìœ„ì¹˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            }
        }
        
        function addRandomSatellite() {
            const satelliteCount = parseInt(document.getElementById('random-satellite-count').value);
            
            // ì„¤ì •ëœ ê°œìˆ˜ë§Œí¼ ìœ„ì„±ì„ ìƒì„±
            for (let count = 0; count < satelliteCount; count++) {
                // í™”ë©´ ê°€ì¥ìë¦¬ì—ì„œ ë¬´ì‘ìœ„ ìœ„ì¹˜ ì„ íƒ
                const edgePositions = [
                    // ìƒë‹¨ ê°€ì¥ìë¦¬
                    { x: Math.random() * width, y: 50 },
                    // í•˜ë‹¨ ê°€ì¥ìë¦¬
                    { x: Math.random() * width, y: height - 50 },
                    // ì¢Œì¸¡ ê°€ì¥ìë¦¬
                    { x: 50, y: Math.random() * height },
                    // ìš°ì¸¡ ê°€ì¥ìë¦¬
                    { x: width - 50, y: Math.random() * height }
                ];
                
                const startPos = edgePositions[Math.floor(Math.random() * edgePositions.length)];
                
                // ë¬´ì‘ìœ„ ë°©í–¥ê³¼ ì†ë„ ìƒì„±
                const angle = Math.random() * Math.PI * 2; // 0 ~ 2Ï€ ëœë¤ ê°ë„
                const speed = 2 + Math.random() * 8; // 2 ~ 10 ëœë¤ ì†ë„
                
                const vx = Math.cos(angle) * speed;
                const vy = Math.sin(angle) * speed;
                
                const newSatellite = {
                    x: startPos.x,
                    y: startPos.y,
                    vx: vx,
                    vy: vy,
                    orbit: [],
                    color: `hsl(${Math.random() * 360}, 70%, 60%)`,
                    id: Date.now() + Math.random() + count
                };
                
                satellites.push(newSatellite);
            }
            
            updateStatus();
        }
        
        function clearSatellites() {
            satellites = [];
            updateStatus();
        }
        
        function toggleCollision() {
            collisionEnabled = !collisionEnabled;
            const btn = document.getElementById('collision-btn');
            btn.textContent = collisionEnabled ? 'ì¶©ëŒ' : 'ë¬´ì ';
            btn.style.opacity = collisionEnabled ? '1' : '0.6';
            btn.style.backgroundColor = collisionEnabled ? '' : '#ddd';
        }
        
        function toggleOrbit() {
            showOrbit = !showOrbit;
            const btn = document.getElementById('orbit-btn');
            btn.textContent = showOrbit ? 'ê¶¤ë„' : 'ê¶¤ë„';
            btn.style.opacity = showOrbit ? '1' : '0.6';
        }
        
        function toggleVelocity() {
            showVelocity = !showVelocity;
            const btn = document.getElementById('velocity-btn');
            btn.textContent = showVelocity ? 'ë°©í–¥' : 'ë°©í–¥';
            btn.style.opacity = showVelocity ? '1' : '0.6';
        }
        
        function resetSim() {
            satellites = [];
            simRunning = false;
            simTime = 0;
            
            document.getElementById('start-btn').style.display = 'inline-block';
            document.getElementById('pause-btn').style.display = 'none';
            
            updatePlanetCount();
            updateStatus();
        }
        
        function startSim() {
            if (satellites.length > 0) {
                simRunning = true;
                document.getElementById('start-btn').style.display = 'none';
                document.getElementById('pause-btn').style.display = 'inline-block';
            }
        }
        
        function pauseSim() {
            simRunning = false;
            document.getElementById('start-btn').style.display = 'inline-block';
            document.getElementById('pause-btn').style.display = 'none';
        }
        
        function updateStatus() {
            let totalSpeed = 0;
            for (const satellite of satellites) {
                totalSpeed += Math.sqrt(satellite.vx ** 2 + satellite.vy ** 2);
            }
            const avgSpeed = satellites.length > 0 ? (totalSpeed / satellites.length).toFixed(2) : 0;
            
            statusBar.textContent = 
                `ë¸”ë™í™€: ${planets.length}ê°œ | ìœ„ì„±: ${satellites.length}ê°œ | í‰ê·  ì†ë„: ${avgSpeed} | ì‹œê°„: ${simTime.toFixed(1)}ì´ˆ`;
        }
        
        function updateUI() {
            updateSpeedMult();
            updateGravityStrength();
            updateRandomCount();
        }
        
        function physics(dt) {
            if (satellites.length === 0) return;
            
            const gravityStrength = parseFloat(document.getElementById('gravity-strength').value);
            
            for (let i = satellites.length - 1; i >= 0; i--) {
                const satellite = satellites[i];
                
                // ì¤‘ë ¥ ê³„ì‚°
                for (const planet of planets) {
                    const dx = planet.x - satellite.x;
                    const dy = planet.y - satellite.y;
                    const distSq = dx * dx + dy * dy;
                    const dist = Math.sqrt(distSq);
                    
                    if (collisionEnabled && dist < planet.radius + 2) {
                        // ì¶©ëŒ ì²˜ë¦¬ - ìœ„ì„± ì œê±° (ì¶©ëŒì´ í™œì„±í™”ëœ ê²½ìš°ë§Œ)
                        satellites.splice(i, 1);
                        continue;
                    }
                    
                    const force = (planet.mass * gravityStrength) / (distSq + 100);
                    const ax = force * dx / dist;
                    const ay = force * dy / dist;
                    
                    satellite.vx += ax * dt;
                    satellite.vy += ay * dt;
                }
                
                if (i >= satellites.length) continue; // ìœ„ì„±ì´ ì œê±°ëœ ê²½ìš° ê±´ë„ˆë›°ê¸°
                
                // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
                satellite.x += satellite.vx * dt;
                satellite.y += satellite.vy * dt;
                
                // ê¶¤ë„ ì¶”ì 
                satellite.orbit.push({ x: satellite.x, y: satellite.y });
                if (satellite.orbit.length > 800) satellite.orbit.shift();
                
                // ê²½ê³„ ì²´í¬
                if (satellite.x < -100 || satellite.x > width + 100 || 
                    satellite.y < -100 || satellite.y > height + 100) {
                    satellites.splice(i, 1);
                    continue;
                }
            }
            
            simTime += dt;
            updateStatus();
        }
        
        function draw() {
            // ë°°ê²½ ê·¸ë¦¬ê¸° (íˆ¬ëª…/ê¸°ë³¸ ë°°ê²½)
            ctx.clearRect(0, 0, width, height);
            
            // ë¸”ë™í™€ ê·¸ë¦¬ê¸°
            for (const planet of planets) {
                // ì‚¬ê±´ì˜ ì§€í‰ì„  (ì–´ë‘ìš´ ê·¸ë¼ë°ì´ì…˜)
                const gradient = ctx.createRadialGradient(
                    planet.x, planet.y, 0,
                    planet.x, planet.y, planet.radius * 3
                );
                gradient.addColorStop(0, '#000000');
                gradient.addColorStop(0.4, 'rgba(50, 50, 50, 0.8)');
                gradient.addColorStop(0.7, 'rgba(100, 100, 100, 0.4)');
                gradient.addColorStop(1, 'rgba(150, 150, 150, 0.1)');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(planet.x, planet.y, planet.radius * 3, 0, Math.PI * 2);
                ctx.fill();
                
                // ë¸”ë™í™€ ë³¸ì²´ (ì™„ì „í•œ ê²€ì€ìƒ‰)
                ctx.fillStyle = '#000000';
                ctx.beginPath();
                ctx.arc(planet.x, planet.y, planet.radius, 0, Math.PI * 2);
                ctx.fill();
                
                // ì–´í¬ë¦¬ì…˜ ë””ìŠ¤í¬ íš¨ê³¼ (íšŒì „í•˜ëŠ” ë§)
                const time = Date.now() * 0.001;
                for (let i = 0; i < 8; i++) {
                    const angle = (time + i * Math.PI / 4) % (Math.PI * 2);
                    const ringRadius = planet.radius * (1.5 + i * 0.2);
                    const alpha = 0.3 - i * 0.03;
                    
                    ctx.strokeStyle = `rgba(255, 150, 50, ${alpha})`;
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(planet.x, planet.y, ringRadius, angle, angle + Math.PI / 3);
                    ctx.stroke();
                }
            }
            
            // ê¶¤ë„ ê·¸ë¦¬ê¸°
            if (showOrbit) {
                for (const satellite of satellites) {
                    if (satellite.orbit.length > 1) {
                        ctx.strokeStyle = satellite.color;
                        ctx.lineWidth = 2;
                        ctx.globalAlpha = 0.7;
                        ctx.beginPath();
                        ctx.moveTo(satellite.orbit[0].x, satellite.orbit[0].y);
                        
                        for (let i = 1; i < satellite.orbit.length; i++) {
                            ctx.lineTo(satellite.orbit[i].x, satellite.orbit[i].y);
                        }
                        ctx.stroke();
                        ctx.globalAlpha = 1;
                    }
                }
            }
            
            // ìœ„ì„±ë“¤ ê·¸ë¦¬ê¸°
            for (const satellite of satellites) {
                // ìœ„ì„± ë³¸ì²´
                ctx.fillStyle = satellite.color;
                ctx.beginPath();
                ctx.arc(satellite.x, satellite.y, 4, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // ì†ë„ ë²¡í„° í‘œì‹œ
                if (showVelocity) {
                    const scale = 2;
                    ctx.strokeStyle = satellite.color;
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(satellite.x, satellite.y);
                    ctx.lineTo(satellite.x + satellite.vx * scale, satellite.y + satellite.vy * scale);
                    ctx.stroke();
                    
                    // í™”ì‚´í‘œ ë
                    const angle = Math.atan2(satellite.vy, satellite.vx);
                    const arrowLength = 8;
                    ctx.beginPath();
                    ctx.moveTo(satellite.x + satellite.vx * scale, satellite.y + satellite.vy * scale);
                    ctx.lineTo(
                        satellite.x + satellite.vx * scale - arrowLength * Math.cos(angle - 0.3),
                        satellite.y + satellite.vy * scale - arrowLength * Math.sin(angle - 0.3)
                    );
                    ctx.moveTo(satellite.x + satellite.vx * scale, satellite.y + satellite.vy * scale);
                    ctx.lineTo(
                        satellite.x + satellite.vx * scale - arrowLength * Math.cos(angle + 0.3),
                        satellite.y + satellite.vy * scale - arrowLength * Math.sin(angle + 0.3)
                    );
                    ctx.stroke();
                }
            }
        }
        
        function loop() {
            if (simRunning) {
                const speedMult = parseFloat(document.getElementById('speed-mult').value);
                physics(0.05 * speedMult);
            }
            
            draw();
            animationId = requestAnimationFrame(loop);
        }
        
        // ì´ˆê¸°í™”
        init();
    </script>
</body>
</html>